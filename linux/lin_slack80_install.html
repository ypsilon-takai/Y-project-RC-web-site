
<html>
<head>
<TITLE>Slack 8.0 導入メモ</TITLE>
	<meta http-equiv="Content-Language" content="ja">
	<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
	<LINK href="../data/default.css" type=text/css rel=stylesheet>
	<LINK href="../data/extended.css" type=text/css rel=stylesheet>
	<LINK href="../data/yosi16.png" type=image/png rel=icon>
</HEAD>
<BODY>
<DIV id=titlebar>
<IMG id=titlebarright alt="" src="../data/yosi.png">
</DIV>

<p>
Slackの8.0が出たので、7.1改からUpdateすることにしました。
普通に使っていて問題があるわけではなかったし、glibcも2.2.2に
したし、Xも4.1.0でGNOMEも1.4だったので、8.0にしても、そのあたりの
メインのところは変わらない状況でした。 しかし、気に入らないところがあって、
gcl(lispです)が動かないことと、SHADEの表示文字がおかしくなっていること。
これを何とかしたいなと思っていたので、これが解決しそうならやってみよう
ということで、古いマシンのHDを借りてきて、インストールしてみました。
gclがちゃんと動いて、tkを通じてwindowを生成できたので、価値ありとみて
まあ、やってみることにしました。
</p>


<h1>インストール</h1>
	あたりまえですね。
	<h2>予定</h2><p>
		基本的には、いつものパターンで、余計なものは
		入れないつもり。アパッチとかTeXとか。 GNOME派なのでKDEは入れません。</p>
	<h2>記録</h2><p>
		予定通り終了。<br>
		カーネルの再構築を実行。使っているもののドライバーのみの構成にした。
		少しは起動が早くなったかな。<br>
		FB(フレームバッファ)のドライバーをいれて、ハイレゾ(古いか？)の画面に
		トライ。しかし、やっぱり起動途中にPCIにささっているMilleniumのほうに画面
		が行ってしまう症状がでる。これをやるとXから戻って来たときに元に戻らない
		症状が出るので、カーネルの起動オプションにそれ関係のものを追加する必要
		があるのだが、lilo.confをバックアップしていないことが判明。もう一度調べる気力
		がないので、しばらくはこのまま。 広いコンソールは、X関連ルールなどの
		コンパイルのときに便利なので、そのうち何とかしたいと思っています。</p>
	<h2>関連資料</h2><ul>
		<li>XF86Configはこちら。</li>
		<li>そのときのXのログはこちら。</li></ul>
<br>
<h1>日本語化</h1>
	<h2>予定</h2><p>
		glibc2.2.xはロケールデータがはいっているので、そのあたりは問題ないでしょう。
		昔に比べるとこの辺はだいぶ楽になりました。一発でたいていのAPLが日本語表示に
		なります。だからあとは入力関連を整備すればOKなわけです。
		kinput2とcannaとEmacs20と漢字対応Etermとあとツールの日本語対応ですね。
		大体PlatHomeさんのパッケージを使うことでしょう。</p>
	<h2>記録</h2><p>
		予定通りPlatHomeさんのパッケージを使用。(感謝感謝)
		入れたのは、canna,less,groff,font,kinput2。</p>
		<h3>locale</h3><p>
			7.0あたりから、/etc/profile内で LC_ALLにPOSIXが設定されるように
			なっていました。あの時はだいぶ苦労して(ただ時間がかかっただけ？)
			見つけたやつです。これをこのままにしておくと、LANGにja_JP.eucJPが
			設定されていても無視されてしまいます。僕はとりあえず、これを
			コメントアウトしてあります。</p>
		<h3>canna</h3><p>
			インストールしただけで、/etc/rc.dに設定ファイルも作ってくれたので、
			立ち上げ時に起動するようになっていた。</p>
		<h3>kinput2</h3><p>
			.xinitrcで起動して、.bashrcに export XMODIFIER="@xim=kinput2" を
			いれて、OK。 Mozillaで日本語入寮句ができることが確認できた。</p>
		<h3>Emacs</h3><p>
			このままでOKかと思いきや M-x canna で canna.el がないといわれてしまう。
			でも C-\ で日本語が起動。 これはなんだ？ 知識が不足ですね。これで
			問題なく動けばいいのですが、なんだか挙動が不審です。問題はいくつか
			ありますが、・[n]の2度押しで「ん」が出ない。(「かんな」が「かんんな」
			になってしまう) ・C-oで文節伸ができない。(XIMの切り替えが起こってしまう。
			そんなわけで、使いにくいのでちょっと調べてみましょう。</p>
			<p>(数日)</p><p>
			ということで調べてみました。挙動としてどうもkinput2が動いてしまっている
			様に見えたことと、EmacsがXIMに対応しているようなので、環境変数の
			XMODIFIERの値を@xim=noneに変更してみました。これで、めでたくC-\で
			何も起動しなくなりました。このままでは、日本語がどおにもならないので、
			googleでEmacsを検索して情報を漁ったところ、こんなページがありました。
			いつもながらありがたいことです。<br>
			ここで、Tamago４がでていて、cannaにも対応しているとあったので、
			導入してみることにしました。まあ、そんなにcannaにこだわりがあるわけでは
			ないのですが、浮気をするならちゃんとできてからというポリシーで。
			リンクにあったここを参考にして、インストール・設定で、無事起動。
			cannaの単語登録もできました。</p>
	<h2>関連資料</h2><ul>
		<li>.emacsはこれ</li></ul>
		
<br>
<h1>タブレット対応</h1><p>
	gtk+は再コンパイルしなければだめ。DualHead対応のへなちょこ自作パッチをあてて
	タブレット対応オプションをつけて再コンパイル。そして、gimpも再コンパイル。</p>
	<h2>gtk+</h2><p>
		このままのgtk+では Dual Head の表示に、①真中に表示されるダイアログ
		などが、二つのモニターの境目に表示されてしまう。②タブレットでコアポインタ
		以外のデバイスの座標の取得がうまくいかない、という問題が発生します。
		特に2番目は僕にとって致命的なので、何とかしなければと、ソースをにらんで
		gtk+1.2.8のときにパッチをつくりました。自分の環境で動けばいいやという
		いいかげんなパッチで、画面サイズを1280x1024と1152x768の
		きめうちで、直値を入れてしまっています。本来はxinerama対応の新しいサイズ取得
		インターフェイスを使うべきですが、そんな変更はする気力がありません。
		それに、gtk+1.3.x系列では、xinerama対応で、そのあたりも直っているみたいなので、
		gtk+2.0.xがリリースされるのを待つことにします。
		パッチをあてようと思ったら、一番大事なところがなんだか前(1.2.8)と
		変わってしまっています。ソースの中をうろうろ探してよさそうなところを見つけて
		直してしまった。基本的には、ルートウィンドウのサイズを取得しているところ
		をみつけて、1280x1024にしてしまうのですが、今回のはいまいち自信がない。
		パッチをあてて、configureのオプションに -xinput=xfree を付け加えて再コンパイル。
		パッチはなんかうまくいってるみたい。不具合が出たらなおすことにしましょう。</p>
	<h2>関連資料</h2><ul>
		<li>gtk+パッチはここ(完璧に無保証です。)</li></ul>
		
<br>
<h1>Shadeインストール</h1><p>
	まあ、入れるだけ。うまくいくといいのだけれど。
	未作業</p><br>
	<p>
	ちゃんと入りました。Shadeのパッケージはrpmなんで、rpm2tgzでtgzをつくって
	そのまま展開してやります。気に入らなかったフォントの問題も治っていて、すっきりですが、
	結局原因はわからずじまい。まあ、よしとしよう。</p>

<br>	
<h1>nautilus再コンパイル</h1><p>
	たぶん、タブのところの日本語文字化けがあるはずなので、パッチをあてて
	再コンパイル。</p>
	<h2>nautilus文字化け対応</h2><p>
		タブのところの日本語が文字化けするのは、フォントのファイルの扱いに
		不具合があるからだとLinux Japanにあったので、対応をすることに。
		記事によると、nautilus内のlibrsvg.cを修正とあったのですが、
		1.0.3では、このライブラリが外出しになっていました。
		全部再コンパイルよりはだいぶ手間が省けました。Slack8.0についてきたソース
		を展開して、修正して、*.buildの内容にあわせてconfigureしてmakeしてmake install。
		ldconfigも忘れずに。これで文字化けも直りました。</p>

<br>
<h1>メーラーを選ぼう</h1><p>
	メーラについては、今までNetscapeのメーラーを使っていました。だいぶ使い慣れた
	ところなのですが、なんだか重いなーと思っています。ちょっと気になるメーラーも
	あったりするので、入れてみましょう。</p>
	<h2>balsa</h2><p>
		バージョンは1.2.1でした。１を超えているから大丈夫なんでしょう。入れてみましょう。
		Webページに必要なライブラリーの情報があったので、それらも含めて、普通に
		make & make install。</p><p>
		うまくインストールできたみたいだけど、1)なんか重い 2)日本語のメールが表示できない。
		メニューなんかは日本語化されているのになぜ？ どおやら2022jpで入ってきたものが
		読めず、EUCにすれば読めるらしい。ためしに、mboxをEUCにしたらよめた。だめだな。</p>
	<h2>sylfeed</h2><p>
		ということで、なんかいいメーラーはないかなとWebで検索していたら、Sylpheedというのに
		ぶつかった。なんと日本の人が作っておられるもののようです。早速getしてconfigして
		makeしてinstallです。とてもいい感じです。複数アカウントに対応していたりなど、
		必要な機能は全てそろっているし、何しろ日本語の表示に問題がない。使ってみる
		ことにしました。</p>
<br>
<h1>TrackMan Marble FX</h2><p>
	PS2マウスプロトコルを設定すれば普通の3つボタンマウスとして使えます。が、最近のXのアプリは
	スクロールホイールに対応しているし、FXの方もWinでは4つ目のボタンでトラックボールでの
	スクロールができるようになっているんだから、やっぱりXでもスクロールが使いたい。
	その昔webで見つけた3.3.6用のパッチも見つかったので、何とかなるでしょう。
	これが修正。これで、XF86ConfigのプロトコルをMARBLEFXに設定すれば、OK。</p><p>
	動作としては、赤いボタンを押している間だけトラックボールでスクロールができます。
	Winと同じような動作にしたのがこれ(工事中)。この場合、どこかに状況を示すインジケータ
	必要だなと思っています。イメージは、マウスカーソルを消して、あったところに十字矢印を表示する
	なんていうのがいいかな。Xのプログラムは組んだことがないので、どうやったらいいのかまったく
	わからないけどね。<p>



</body>
</html>


	










